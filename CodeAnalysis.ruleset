<?xml version="1.0" encoding="utf-8"?>
<RuleSet Name="MSP430 Emulator Code Analysis Rules" Description="Enhanced static analysis rules for MSP430 Emulator project focusing on CodeQL issues" ToolsVersion="16.0">
  <IncludeAll Action="Info" />
  
  <!-- CodeQL-inspired rules for the specific issues mentioned in the comment -->
  
  <!-- Issue #1: Generic catch clauses -->
  <Rules AnalyzerId="Microsoft.CodeAnalysis.CSharp" RuleNamespace="Microsoft.CodeAnalysis.CSharp">
    <Rule Id="CA1031" Action="Warning" /> <!-- Do not catch general exception types -->
  </Rules>
  
  <!-- Issue #3: IDisposable patterns -->
  <Rules AnalyzerId="Microsoft.CodeAnalysis.CSharp" RuleNamespace="Microsoft.CodeAnalysis.CSharp">
    <Rule Id="CA2000" Action="Warning" /> <!-- Dispose objects before losing scope -->
    <Rule Id="CA1063" Action="Info" />    <!-- Implement IDisposable correctly -->
    <Rule Id="CA2213" Action="Info" />    <!-- Disposable fields should be disposed -->
  </Rules>
  
  <!-- Issue #2: Path operations - note that there's no specific analyzer rule for Path.Combine vs Path.Join -->
  <!-- This would need to be caught through custom code review or additional tooling -->
  
  <!-- Keep other important security and reliability rules as info -->
  <Rules AnalyzerId="Microsoft.CodeAnalysis.CSharp" RuleNamespace="Microsoft.CodeAnalysis.CSharp">
    <Rule Id="CA5394" Action="Info" />    <!-- Do not use insecure randomness -->
    <Rule Id="CA5359" Action="Info" />    <!-- Do not disable certificate validation -->
    <Rule Id="CA2227" Action="Info" />    <!-- Collection properties should be read only -->
  </Rules>
  
  <!-- Disable noisy rules that aren't related to the CodeQL issues -->
  <Rules AnalyzerId="Microsoft.CodeAnalysis.CSharp" RuleNamespace="Microsoft.CodeAnalysis.CSharp">
    <Rule Id="CA1805" Action="None" />    <!-- Member is explicitly initialized to its default value -->
    <Rule Id="CA1024" Action="None" />    <!-- Use properties where appropriate -->
    <Rule Id="CA1822" Action="None" />    <!-- Member can be marked as static -->
    <Rule Id="CA1311" Action="None" />    <!-- Specify a culture -->
    <Rule Id="CA1869" Action="None" />    <!-- Cache JsonSerializerOptions -->
    <Rule Id="CA1304" Action="None" />    <!-- String operations culture -->
    <Rule Id="CA1716" Action="None" />    <!-- Reserved keyword conflicts -->
    <Rule Id="CA1845" Action="None" />    <!-- Use span-based operations -->
    <Rule Id="CA1707" Action="None" />    <!-- Remove underscores from names (common in test method names) -->
    <Rule Id="CA1816" Action="None" />    <!-- GC.SuppressFinalize for tests -->
    <Rule Id="CA1852" Action="None" />    <!-- Type can be sealed -->
  </Rules>
</RuleSet>