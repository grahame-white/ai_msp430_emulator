<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="800" height="600" viewBox="0 0 800 600">
  <defs>
    <!-- Define styles for consistent appearance -->
    <style>
      .block-rect { fill: #f0f8ff; stroke: #1e3a8a; stroke-width: 2; }
      .multiplexor { fill: #fff3cd; stroke: #856404; stroke-width: 2; }
      .divider { fill: #d1ecf1; stroke: #0c5460; stroke-width: 2; }
      .counter { fill: #fff3e0; stroke: #e65100; stroke-width: 2; }
      .control { fill: #f3e5f5; stroke: #6a1b9a; stroke-width: 2; }
      .connection { stroke: #333; stroke-width: 2; fill: none; }
      .bus { stroke: #333; stroke-width: 4; fill: none; }
      .label { font-family: Arial, sans-serif; font-size: 12px; fill: #333; text-anchor: middle; }
      .signal-label { font-family: Arial, sans-serif; font-size: 10px; fill: #666; text-anchor: middle; }
      .connection-dot { fill: #333; }
      .branch-point { fill: #333; }
    </style>
    
    <!-- Arrow marker definition -->
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#333" />
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="400" y="25" class="label" style="font-size: 16px; font-weight: bold;">Timer A Main Block Diagram</text>
  
  <!-- Clock Input Signals -->
  <text x="50" y="80" class="signal-label">TAxCLK</text>
  <text x="50" y="110" class="signal-label">ACLK</text>
  <text x="50" y="140" class="signal-label">SMCLK</text>
  <text x="50" y="170" class="signal-label">INCLK</text>
  
  <!-- TASSEL Multiplexor -->
  <polygon points="120,70 180,70 190,100 180,130 120,130 130,100" class="multiplexor"/>
  <text x="155" y="95" class="label">TASSEL</text>
  <text x="155" y="110" class="label" style="font-size: 10px;">2-bit MUX</text>
  <text x="135" y="85" class="signal-label">00</text>
  <text x="135" y="105" class="signal-label">01</text>
  <text x="135" y="115" class="signal-label">10</text>
  <text x="135" y="125" class="signal-label">11</text>
  
  <!-- Input connections to TASSEL -->
  <line x1="80" y1="80" x2="120" y2="80" class="connection" marker-end="url(#arrowhead)"/>
  <line x1="80" y1="110" x2="120" y2="110" class="connection" marker-end="url(#arrowhead)"/>
  <line x1="80" y1="140" x2="100" y2="140" class="connection"/>
  <line x1="100" y1="140" x2="100" y2="120" class="connection"/>
  <line x1="100" y1="120" x2="120" y2="120" class="connection" marker-end="url(#arrowhead)"/>
  <line x1="80" y1="170" x2="90" y2="170" class="connection"/>
  <line x1="90" y1="170" x2="90" y2="125" class="connection"/>
  <line x1="90" y1="125" x2="120" y2="125" class="connection" marker-end="url(#arrowhead)"/>
  
  <!-- ID Divider -->
  <rect x="240" y="75" width="80" height="50" class="divider"/>
  <text x="280" y="95" class="label">ID</text>
  <text x="280" y="110" class="label" style="font-size: 10px;">Divider</text>
  <text x="280" y="120" class="label" style="font-size: 8px;">รท1,2,4,8</text>
  
  <!-- TASSEL to ID connection -->
  <line x1="190" y1="100" x2="240" y2="100" class="connection" marker-end="url(#arrowhead)"/>
  
  <!-- IDEX Divider -->
  <rect x="370" y="75" width="80" height="50" class="divider"/>
  <text x="410" y="95" class="label">IDEX</text>
  <text x="410" y="110" class="label" style="font-size: 10px;">Divider</text>
  <text x="410" y="120" class="label" style="font-size: 8px;">รท1-8</text>
  
  <!-- ID to IDEX connection -->
  <line x1="320" y1="100" x2="370" y2="100" class="connection" marker-end="url(#arrowhead)"/>
  
  <!-- Timer Clock output label -->
  <text x="500" y="105" class="signal-label">Timer Clock</text>
  
  <!-- IDEX to Timer Clock connection -->
  <line x1="450" y1="100" x2="480" y2="100" class="connection" marker-end="url(#arrowhead)"/>
  
  <!-- Timer Clock distribution point -->
  <circle cx="520" cy="100" r="3" class="branch-point"/>
  
  <!-- Vertical line down for distribution -->
  <line x1="520" y1="100" x2="520" y2="200" class="connection"/>
  
  <!-- TAxR Counter -->
  <rect x="220" y="220" width="120" height="80" class="counter"/>
  <text x="280" y="245" class="label">TAxR</text>
  <text x="280" y="260" class="label" style="font-size: 10px;">16-bit Counter</text>
  
  <!-- Clock input to TAxR -->
  <line x1="520" y1="200" x2="340" y2="200" class="connection"/>
  <line x1="340" y1="200" x2="340" y2="220" class="connection" marker-end="url(#arrowhead)"/>
  <text x="350" y="215" class="signal-label">CLK</text>
  
  <!-- TACLR input -->
  <text x="150" y="250" class="signal-label">TACLR</text>
  <line x1="180" y1="250" x2="220" y2="250" class="connection" marker-end="url(#arrowhead)"/>
  <text x="190" y="245" class="signal-label">CLR</text>
  
  <!-- Mode Control (MC) -->
  <rect x="400" y="220" width="100" height="80" class="control"/>
  <text x="450" y="245" class="label">MC</text>
  <text x="450" y="260" class="label" style="font-size: 10px;">Mode Control</text>
  <text x="450" y="275" class="label" style="font-size: 8px;">2-bit</text>
  
  <!-- Bidirectional connection between TAxR and MC -->
  <line x1="340" y1="240" x2="400" y2="240" class="connection"/>
  <line x1="400" y1="260" x2="340" y2="260" class="connection"/>
  <text x="370" y="235" class="signal-label">Mode</text>
  <text x="370" y="275" class="signal-label">Mode</text>
  
  <!-- EQU0 input to MC -->
  <text x="550" y="250" class="signal-label">EQU0</text>
  <line x1="530" y1="250" x2="500" y2="250" class="connection" marker-end="url(#arrowhead)"/>
  <text x="510" y="245" class="signal-label">CMP</text>
  
  <!-- Count output bus -->
  <line x1="280" y1="300" x2="280" y2="350" class="bus"/>
  <text x="290" y="340" class="signal-label">Count (16-bit Bus)</text>
  
  <!-- Distribution branches for Count bus -->
  <circle cx="280" cy="350" r="4" class="branch-point"/>
  <line x1="280" y1="350" x2="150" y2="350" class="bus"/>
  <line x1="280" y1="350" x2="410" y2="350" class="bus"/>
  <line x1="280" y1="350" x2="550" y2="350" class="bus"/>
  
  <!-- Count bus labels -->
  <text x="150" y="365" class="signal-label">To CCR0</text>
  <text x="410" y="365" class="signal-label">To CCR1-3</text>
  <text x="550" y="365" class="signal-label">To CCR4-6</text>
  
  <!-- RC (Roll-over/Carry) output -->
  <line x1="320" y1="280" x2="370" y2="280" class="connection"/>
  <line x1="370" y1="280" x2="370" y2="320" class="connection"/>
  <text x="380" y="295" class="signal-label">RC</text>
  
  <!-- TAIFG output -->
  <rect x="420" y="310" width="60" height="30" class="block-rect"/>
  <text x="450" y="330" class="label" style="font-size: 10px;">TAIFG</text>
  <line x1="370" y1="320" x2="390" y2="320" class="connection"/>
  <line x1="390" y1="320" x2="390" y2="325" class="connection"/>
  <line x1="390" y1="325" x2="420" y2="325" class="connection" marker-end="url(#arrowhead)"/>
  <text x="390" y="315" class="signal-label">set</text>
  
  <!-- Clear signal distribution -->
  <line x1="200" y1="250" x2="200" y2="180" class="connection"/>
  <circle cx="200" cy="180" r="3" class="branch-point"/>
  <line x1="200" y1="180" x2="280" y2="180" class="connection"/>
  <line x1="200" y1="180" x2="120" y2="180" class="connection"/>
  
  <!-- Clear connections to dividers -->
  <line x1="280" y1="180" x2="280" y2="125" class="connection" marker-end="url(#arrowhead)"/>
  <line x1="410" y1="180" x2="410" y2="125" class="connection" marker-end="url(#arrowhead)"/>
  <line x1="280" y1="180" x2="410" y2="180" class="connection"/>
  
  <text x="250" y="175" class="signal-label">CLR</text>
  <text x="380" y="175" class="signal-label">CLR</text>
  
  <!-- Clock Path grouping box -->
  <rect x="100" y="50" width="400" height="100" fill="none" stroke="#666" stroke-width="1" stroke-dasharray="5,5"/>
  <text x="300" y="45" class="label" style="font-size: 14px; fill: #666;">Clock Path</text>
  
  <!-- Timer Core grouping box -->
  <rect x="200" y="200" width="320" height="160" fill="none" stroke="#666" stroke-width="1" stroke-dasharray="5,5"/>
  <text x="360" y="195" class="label" style="font-size: 14px; fill: #666;">Timer Core</text>
  
</svg>